<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Director's Statement Generator - Festival Ready</title>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-106157234"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-106157234', {
        'cookie_domain': 'filmfestivalcircuit.com',
        'cookie_flags': 'SameSite=None;Secure'
      });
    </script>
    
    <!-- PDF.js Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    
    <!-- Supabase Client -->
    <script type="module">
        import { createClient } from 'https://esm.sh/@supabase/supabase-js@2.45.4';
        
        const SUPABASE_URL = 'https://vmfhxkfprrbshwniguaq.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZtZmh4a2ZwcnJic2h3bmlndWFxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk2ODYxNTcsImV4cCI6MjA2NTI2MjE1N30.k0OdvFzcO1nwZzxsgLPcQBeSITmV6dA_ncXpN0cpAgQ';
        
        const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        window.supabase = supabase;
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: white;
            color: #333;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #667eea;
        }
        
        .header p {
            font-size: 1.1em;
            color: #666;
        }
        
        .form-container {
            background: white;
            border-radius: 10px;
            padding: 40px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 1em;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 120px;
        }
        
        .form-group-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .genre-checkboxes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 8px;
        }
        
        .genre-checkbox {
            display: flex;
            align-items: center;
        }
        
        .genre-checkbox input {
            width: auto;
            margin-right: 8px;
        }
        
        .character-counter {
            text-align: right;
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }
        
        .character-counter.warning {
            color: #ff9500;
        }
        
        .character-counter.error {
            color: #e74c3c;
        }
        
        .file-upload-area {
            border: 2px dashed #e0e0e0;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .file-upload-area:hover,
        .file-upload-area.drag-over {
            border-color: #667eea;
            background-color: #f8f9ff;
        }
        
        .file-upload-area input[type="file"] {
            display: none;
        }
        
        .upload-text {
            color: #666;
            font-size: 1em;
        }
        
        .upload-text strong {
            color: #667eea;
        }
        
        .privacy-disclaimer {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin: 25px 0;
        }
        
        .privacy-disclaimer h3 {
            color: #28a745;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        
        .privacy-disclaimer p {
            margin-bottom: 10px;
            color: #495057;
        }
        
        .marketing-optin {
            background: #f8f9ff;
            border: 1px solid #667eea;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .marketing-optin label {
            display: flex;
            align-items: center;
            font-weight: normal;
            cursor: pointer;
        }
        
        .marketing-optin input {
            width: auto;
            margin-right: 10px;
        }
        
        .email-verify {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .submit-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            box-shadow: 0 4px 6px rgba(102, 126, 234, 0.3);
        }
        
        .submit-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(102, 126, 234, 0.4);
        }
        
        .submit-button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border: 1px solid #f5c6cb;
        }
        
        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border: 1px solid #c3e6cb;
        }
        
        .pdf-message {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-size: 0.9em;
        }
        
        .pdf-message-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .pdf-message-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .pdf-message-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #b8daff;
        }
        
        /* Honeypot field - hidden from users */
        .honeypot {
            position: absolute;
            left: -9999px;
            opacity: 0;
            pointer-events: none;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .form-container {
                padding: 20px;
            }
            
            .form-group-row {
                grid-template-columns: 1fr;
            }
            
            .email-verify {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸŽ¬ Director's Statement Generator</h1>
            <p>Create a professional director's statement for your film festival submissions using AI</p>
        </div>
        
        <!-- Book Banner Container -->
        <div id="book-banner-container"></div>
        
        <div class="form-container">
            <form id="directorsStatementForm">
                <!-- Honeypot field (hidden from users, visible to bots) -->
                <div class="honeypot">
                    <label for="website">Website</label>
                    <input type="text" id="website" name="website" tabindex="-1" autocomplete="off">
                </div>
                
                <div class="form-group">
                    <label for="submissionTitle">Project Title *</label>
                    <input type="text" id="submissionTitle" name="submission_title" required 
                           placeholder="Enter your film's title">
                </div>
                
                <div class="form-group-row">
                    <div class="form-group">
                        <label for="country">Country *</label>
                        <select id="country" name="country" required>
                            <option value="">Select Country</option>
                            <option value="US">United States</option>
                            <option value="CA">Canada</option>
                            <option value="GB">United Kingdom</option>
                            <option value="AU">Australia</option>
                            <option value="DE">Germany</option>
                            <option value="FR">France</option>
                            <option value="IT">Italy</option>
                            <option value="ES">Spain</option>
                            <option value="MX">Mexico</option>
                            <option value="BR">Brazil</option>
                            <option value="IN">India</option>
                            <option value="JP">Japan</option>
                            <option value="KR">South Korea</option>
                            <option value="CN">China</option>
                            <option value="OTHER">Other</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="duration">Film Duration (minutes) *</label>
                        <input type="number" id="duration" name="duration" required min="1" max="300"
                               placeholder="e.g., 15">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="projectType">Project Type *</label>
                    <select id="projectType" name="project_type" required>
                        <option value="">Select Project Type</option>
                        <option value="short_film">Short Film</option>
                        <option value="feature_film">Feature Film</option>
                        <option value="documentary">Documentary</option>
                        <option value="music_video">Music Video</option>
                        <option value="commercial">Commercial</option>
                        <option value="web_series">Web Series</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Genre (select all that apply) *</label>
                    <div class="genre-checkboxes">
                        <div class="genre-checkbox">
                            <input type="checkbox" id="drama" name="genre" value="drama">
                            <label for="drama">Drama</label>
                        </div>
                        <div class="genre-checkbox">
                            <input type="checkbox" id="comedy" name="genre" value="comedy">
                            <label for="comedy">Comedy</label>
                        </div>
                        <div class="genre-checkbox">
                            <input type="checkbox" id="thriller" name="genre" value="thriller">
                            <label for="thriller">Thriller</label>
                        </div>
                        <div class="genre-checkbox">
                            <input type="checkbox" id="horror" name="genre" value="horror">
                            <label for="horror">Horror</label>
                        </div>
                        <div class="genre-checkbox">
                            <input type="checkbox" id="action" name="genre" value="action">
                            <label for="action">Action</label>
                        </div>
                        <div class="genre-checkbox">
                            <input type="checkbox" id="romance" name="genre" value="romance">
                            <label for="romance">Romance</label>
                        </div>
                        <div class="genre-checkbox">
                            <input type="checkbox" id="scifi" name="genre" value="sci-fi">
                            <label for="scifi">Sci-Fi</label>
                        </div>
                        <div class="genre-checkbox">
                            <input type="checkbox" id="fantasy" name="genre" value="fantasy">
                            <label for="fantasy">Fantasy</label>
                        </div>
                        <div class="genre-checkbox">
                            <input type="checkbox" id="documentary" name="genre" value="documentary">
                            <label for="documentary">Documentary</label>
                        </div>
                        <div class="genre-checkbox">
                            <input type="checkbox" id="animation" name="genre" value="animation">
                            <label for="animation">Animation</label>
                        </div>
                        <div class="genre-checkbox">
                            <input type="checkbox" id="experimental" name="genre" value="experimental">
                            <label for="experimental">Experimental</label>
                        </div>
                        <div class="genre-checkbox">
                            <input type="checkbox" id="other_genre" name="genre" value="other">
                            <label for="other_genre">Other</label>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="role">Your Role in This Project *</label>
                    <input type="text" id="role" name="role" required 
                           placeholder="e.g., Director, Writer-Director, Director-Producer">
                </div>
                
                <div class="form-group">
                    <label for="submissionInspiration">What inspired you to create this project? *</label>
                    <textarea id="submissionInspiration" name="submission_inspiration" required
                              placeholder="Describe the original inspiration, concept, or moment that led to this project..."></textarea>
                    <div class="character-counter" id="inspirationCounter">0/1000</div>
                </div>
                
                <div class="form-group">
                    <label for="learning">What did you learn or discover while making this project? *</label>
                    <textarea id="learning" name="learning" required
                              placeholder="Describe new techniques, insights, or personal growth from this project..."></textarea>
                    <div class="character-counter" id="learningCounter">0/1000</div>
                </div>
                
                <div class="form-group">
                    <label for="relevantWorkExperience">Relevant filmmaking experience *</label>
                    <textarea id="relevantWorkExperience" name="relevant_work_experience" required
                              placeholder="Previous films, awards, education, or professional experience in filmmaking..."></textarea>
                    <div class="character-counter" id="workExpCounter">0/1000</div>
                </div>
                
                <div class="form-group">
                    <label for="nonFilmExperience">Non-film industry background (optional)</label>
                    <textarea id="nonFilmExperience" name="non_film_industry_experience"
                              placeholder="Other professional experience, education, or life experiences that inform your filmmaking..."></textarea>
                    <div class="character-counter" id="nonFilmCounter">0/500</div>
                </div>
                
                <div class="form-group">
                    <label for="creativeinspiration">Creative influences and inspirations *</label>
                    <textarea id="creativeinspiration" name="inspirations_creative" required
                              placeholder="Films, directors, artists, books, or other creative works that influence your style..."></textarea>
                    <div class="character-counter" id="creativeCounter">0/800</div>
                </div>
                
                <div class="form-group">
                    <label for="peopleinspiration">People who inspire your work (optional)</label>
                    <textarea id="peopleinspiration" name="inspirations_people"
                              placeholder="Mentors, collaborators, family members, or public figures who inspire your filmmaking..."></textarea>
                    <div class="character-counter" id="peopleCounter">0/500</div>
                </div>
                
                <div class="form-group">
                    <label for="community">Your filmmaking community and collaborations *</label>
                    <textarea id="community" name="community" required
                              placeholder="Describe your creative community, frequent collaborators, or network..."></textarea>
                    <div class="character-counter" id="communityCounter">0/800</div>
                </div>
                
                <div class="form-group">
                    <label for="audience">Target audience and why this story matters *</label>
                    <textarea id="audience" name="audience" required
                              placeholder="Who is your intended audience and why should they care about this story?"></textarea>
                    <div class="character-counter" id="audienceCounter">0/800</div>
                </div>
                
                <div class="form-group">
                    <label for="goals">Your goals as a filmmaker *</label>
                    <textarea id="goals" name="goals" required
                              placeholder="Short-term and long-term goals, the impact you want to make, or the types of stories you want to tell..."></textarea>
                    <div class="character-counter" id="goalsCounter">0/800</div>
                </div>
                
                <div class="form-group">
                    <label for="plot">Brief plot summary or project description *</label>
                    <textarea id="plot" name="plot" required
                              placeholder="A concise summary of your film's story, concept, or main elements..."></textarea>
                    <div class="character-counter" id="plotCounter">0/500</div>
                </div>
                
                <div class="form-group">
                    <label for="projectLocation">Filming location(s) *</label>
                    <input type="text" id="projectLocation" name="project_location" required
                           placeholder="e.g., Los Angeles, CA or Multiple locations in Texas">
                </div>
                
                <div class="form-group">
                    <label for="scriptUpload">Upload Script or Treatment (PDF, optional)</label>
                    <div class="file-upload-area" onclick="document.getElementById('scriptUpload').click()">
                        <input type="file" id="scriptUpload" name="script_upload" accept=".pdf">
                        <div class="upload-text">
                            <strong>Click to upload</strong> or drag and drop your PDF here<br>
                            <small>Maximum file size: 10MB</small>
                        </div>
                    </div>
                    <textarea id="scriptText" name="script_text" style="display: none;" 
                              placeholder="Extracted text from your PDF will appear here..."></textarea>
                </div>
                
                <!-- Personal Information -->
                <h3 style="margin: 30px 0 20px 0; color: #667eea;">Personal Information</h3>
                
                <div class="form-group-row">
                    <div class="form-group">
                        <label for="firstName">First Name *</label>
                        <input type="text" id="firstName" name="first_name" required
                               placeholder="Your first name">
                    </div>
                    
                    <div class="form-group">
                        <label for="lastName">Last Name *</label>
                        <input type="text" id="lastName" name="last_name" required
                               placeholder="Your last name">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="email">Email Address *</label>
                    <div class="email-verify">
                        <div>
                            <input type="email" id="email" name="email" required
                                   placeholder="your.email@example.com">
                        </div>
                        <div>
                            <input type="email" id="emailConfirm" name="email_confirm" required
                                   placeholder="Confirm your email address"
                                   oncopy="return false" onpaste="return false">
                        </div>
                    </div>
                </div>
                
                <!-- Privacy Disclaimer -->
                <div class="privacy-disclaimer">
                    <h3>ðŸ”’ Your Intellectual Property is Protected</h3>
                    <p><strong>We do not use your screenplays, stories, or creative content for AI training purposes.</strong> Your intellectual property remains yours. All submissions are processed solely to generate your requested materials and are not shared with third parties or used to improve AI models.</p>
                    <p>By submitting this form, you acknowledge that you own or have rights to the submitted content.</p>
                </div>
                
                <!-- Marketing Opt-in -->
                <div class="marketing-optin">
                    <label>
                        <input type="checkbox" id="marketingOptin" name="marketing_optin" value="true">
                        Yes, I'd like to receive updates about film festival deadlines, submission tips, and new Festival Ready features. (Optional)
                    </label>
                </div>
                
                <div id="formMessages"></div>
                
                <button type="submit" class="submit-button" id="submitButton">
                    Generate My Director's Statement
                </button>
            </form>
        </div>
    </div>
    
    <!-- Load shared components -->
    <script src="https://raw.githubusercontent.com/mikelfair/festival-ready/main/pdf-extraction.js"></script>
    <script src="https://raw.githubusercontent.com/mikelfair/festival-ready/main/book-banner.js"></script>
    
    <script>
        // Initialize components when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize book banner
            createBookBanner('book-banner-container', 'directors-statement');
            
            // Initialize PDF upload
            initializePDFUpload('scriptUpload', 'scriptText', 5000);
            
            // Initialize character counters
            const textareas = [
                { id: 'submissionInspiration', counter: 'inspirationCounter', max: 1000 },
                { id: 'learning', counter: 'learningCounter', max: 1000 },
                { id: 'relevantWorkExperience', counter: 'workExpCounter', max: 1000 },
                { id: 'nonFilmExperience', counter: 'nonFilmCounter', max: 500 },
                { id: 'creativeinspiration', counter: 'creativeCounter', max: 800 },
                { id: 'peopleinspiration', counter: 'peopleCounter', max: 500 },
                { id: 'community', counter: 'communityCounter', max: 800 },
                { id: 'audience', counter: 'audienceCounter', max: 800 },
                { id: 'goals', counter: 'goalsCounter', max: 800 },
                { id: 'plot', counter: 'plotCounter', max: 500 }
            ];
            
            textareas.forEach(item => {
                initializeCharacterCounter(item.id, item.max, item.counter);
            });
            
            // Initialize form submission
            document.getElementById('directorsStatementForm').addEventListener('submit', handleFormSubmission);
        });
        
        async function handleFormSubmission(event) {
            event.preventDefault();
            
            const submitButton = document.getElementById('submitButton');
            const messagesDiv = document.getElementById('formMessages');
            
            // Clear previous messages
            messagesDiv.innerHTML = '';
            
            try {
                // Validate form
                if (!validateForm()) {
                    return;
                }
                
                // Disable submit button
                submitButton.disabled = true;
                submitButton.textContent = 'Processing...';
                
                // Collect form data
                const formData = collectFormData();
                
                // Check honeypot
                if (formData.website && formData.website.trim() !== '') {
                    // Likely a bot - silently fail
                    showMessage('Thank you for your submission. You will receive an email shortly.', 'success');
                    return;
                }
                
                // Track form submission
                gtag('event', 'form_submit', {
                    'event_category': 'Tool_Usage',
                    'event_label': 'directors-statement',
                    'value': 1
                });
                
                // Submit to Supabase
                const { data, error } = await supabase
                    .from('directors_statements')
                    .insert([formData])
                    .select();
                
                if (error) {
                    throw error;
                }
                
                // Redirect to processing selection page
                const submissionId = data[0].id;
                window.location.href = `processing-selection.html?id=${submissionId}&tool=directors-statement`;
                
            } catch (error) {
                console.error('Submission error:', error);
                showMessage('An error occurred while submitting your form. Please try again.', 'error');
                
                // Re-enable submit button
                submitButton.disabled = false;
                submitButton.textContent = 'Generate My Director\'s Statement';
            }
        }
        
        function validateForm() {
            const email = document.getElementById('email').value;
            const emailConfirm = document.getElementById('emailConfirm').value;
            
            if (email !== emailConfirm) {
                showMessage('Email addresses do not match. Please check and try again.', 'error');
                return false;
            }
            
            // Check that at least one genre is selected
            const genres = document.querySelectorAll('input[name="genre"]:checked');
            if (genres.length === 0) {
                showMessage('Please select at least one genre.', 'error');
                return false;
            }
            
            return true;
        }
        
        function collectFormData() {
            const form = document.getElementById('directorsStatementForm');
            const formData = new FormData(form);
            
            // Collect genre checkboxes
            const genres = [];
            document.querySelectorAll('input[name="genre"]:checked').forEach(checkbox => {
                genres.push(checkbox.value);
            });
            
            // Build submission object
            const submission = {
                submission_title: formData.get('submission_title'),
                country: formData.get('country'),
                duration: parseInt(formData.get('duration')),
                project_type: formData.get('project_type'),
                genre: JSON.stringify(genres),
                role: formData.get('role'),
                submission_inspiration: formData.get('submission_inspiration'),
                learning: formData.get('learning'),
                relevant_work_experience: formData.get('relevant_work_experience'),
                non_film_industry_experience: formData.get('non_film_industry_experience'),
                inspirations_creative: formData.get('inspirations_creative'),
                inspirations_people: formData.get('inspirations_people'),
                community: formData.get('community'),
                audience: formData.get('audience'),
                goals: formData.get('goals'),
                plot: formData.get('plot'),
                project_location: formData.get('project_location'),
                script_text: formData.get('script_text'),
                first_name: formData.get('first_name'),
                last_name: formData.get('last_name'),
                email: formData.get('email'),
                website: formData.get('website'), // Honeypot
                marketing_optin: formData.get('marketing_optin') === 'true',
                processing_tier: 'pending'
            };
            
            return submission;
        }
        
        function showMessage(message, type) {
            const messagesDiv = document.getElementById('formMessages');
            const messageElement = document.createElement('div');
            messageElement.className = type === 'error' ? 'error-message' : 'success-message';
            messageElement.textContent = message;
            messagesDiv.appendChild(messageElement);
            
            // Scroll to message
            messageElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
    </script>
</body>
</html>