<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Writer's Biography Generator - Festival Ready v3.0</title>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-F2CSZ9KX52"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-F2CSZ9KX52');
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 60px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }
        
        .form-container {
            padding: 40px;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 1rem;
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 0.95rem;
            transition: border-color 0.3s ease;
            font-family: inherit;
        }
        
        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .char-count {
            text-align: right;
            font-size: 0.85rem;
            color: #666;
            margin-top: 5px;
        }
        
        .char-count.warning {
            color: #e74c3c;
        }
        
        .required {
            color: #e74c3c;
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s ease;
            width: 100%;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
        }
        
        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .checkbox-group {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 25px;
        }
        
        .checkbox-group input[type="checkbox"] {
            width: auto;
            margin-top: 3px;
        }
        
        .checkbox-group label {
            margin-bottom: 0;
            font-weight: 400;
            flex: 1;
            font-size: 0.9rem;
        }
        
        .honeypot {
            position: absolute;
            left: -9999px;
            opacity: 0;
        }
        
        .email-match-error {
            color: #e74c3c;
            font-size: 0.85rem;
            margin-top: 5px;
            display: none;
        }
        
        .home-button {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .home-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        .personal-info-section {
            background: rgba(102, 126, 234, 0.03);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }
        
        .genre-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 8px;
        }
        
        .genre-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .genre-item input[type="checkbox"] {
            width: auto;
        }
        
        .genre-item label {
            margin: 0;
            font-weight: 400;
            font-size: 0.9rem;
        }
        
        .genre-section {
            background: rgba(128, 128, 128, 0.1);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
        }
        
        .processing-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .option-card {
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .option-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }
        
        .option-card.selected {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }
        
        .option-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }
        
        .option-description {
            color: #666;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .option-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 0;
            width: 100%;
        }
        
        .option-btn:hover {
            background: #5a67d8;
            transform: translateY(-1px);
        }
        
        .premium-btn {
            background: #ff6b6b;
        }
        
        .premium-btn:hover {
            background: #ff5252;
        }
        
        .test-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border: 2px solid #e9ecef;
        }
        
        .test-section h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        .test-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .test-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .test-btn:hover {
            background: #218838;
            transform: translateY(-1px);
        }
        
        .test-btn.clear {
            background: #dc3545;
        }
        
        .test-btn.clear:hover {
            background: #c82333;
        }
    </style>
</head>
<body>
    <a href="../index.html" class="home-button">‚Üê Home</a>
    
    <div class="container">
        <div class="header">
            <h1>‚úçÔ∏è Writer's Biography Generator</h1>
            <p>Use this tool to create an industry standard Writer Biography for your film festival submission forms with optimal length, format and doesn't look like a job resume.</p>
        </div>
        
        <div class="form-container">
            <div class="test-section">
                <h3>üß™ Test Mode</h3>
                <div class="test-buttons">
                    <button type="button" class="test-btn" onclick="fillTestData()">Fill Test Data</button>
                    <button type="button" class="test-btn clear" onclick="clearForm()">Clear Form</button>
                </div>
            </div>
            
            <form id="writersBiographyForm">
                <!-- Honeypot field -->
                <input type="text" name="website" class="honeypot" tabindex="-1" autocomplete="off">
                
                <div class="personal-info-section">
                    <div class="form-row">
                    <div class="form-group">
                        <label for="first_name">First Name <span class="required">*</span></label>
                        <input type="text" id="first_name" name="first_name" required>
                    </div>
                    <div class="form-group">
                        <label for="last_name">Last Name <span class="required">*</span></label>
                        <input type="text" id="last_name" name="last_name" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="email">Email Address <span class="required">*</span></label>
                    <input type="email" id="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label for="emailConfirm">Confirm Email Address <span class="required">*</span></label>
                    <input type="email" id="emailConfirm" name="emailConfirm" required>
                    <div class="email-match-error" id="emailError">Email addresses do not match</div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="country">Country <span class="required">*</span></label>
                        <select id="country" name="country" required>
                            <option value="">Select country</option>
                            <option value="United States">United States</option>
                            <option value="Canada">Canada</option>
                            <option value="United Kingdom">United Kingdom</option>
                            <option value="Afghanistan">Afghanistan</option>
                            <option value="Albania">Albania</option>
                            <option value="Algeria">Algeria</option>
                            <option value="Argentina">Argentina</option>
                            <option value="Armenia">Armenia</option>
                            <option value="Australia">Australia</option>
                            <option value="Austria">Austria</option>
                            <option value="Azerbaijan">Azerbaijan</option>
                            <option value="Bahrain">Bahrain</option>
                            <option value="Bangladesh">Bangladesh</option>
                            <option value="Belarus">Belarus</option>
                            <option value="Belgium">Belgium</option>
                            <option value="Bolivia">Bolivia</option>
                            <option value="Brazil">Brazil</option>
                            <option value="Bulgaria">Bulgaria</option>
                            <option value="Cambodia">Cambodia</option>
                            <option value="Chile">Chile</option>
                            <option value="China">China</option>
                            <option value="Colombia">Colombia</option>
                            <option value="Croatia">Croatia</option>
                            <option value="Czech Republic">Czech Republic</option>
                            <option value="Denmark">Denmark</option>
                            <option value="Ecuador">Ecuador</option>
                            <option value="Egypt">Egypt</option>
                            <option value="Estonia">Estonia</option>
                            <option value="Finland">Finland</option>
                            <option value="France">France</option>
                            <option value="Germany">Germany</option>
                            <option value="Greece">Greece</option>
                            <option value="Hungary">Hungary</option>
                            <option value="Iceland">Iceland</option>
                            <option value="India">India</option>
                            <option value="Indonesia">Indonesia</option>
                            <option value="Iran">Iran</option>
                            <option value="Iraq">Iraq</option>
                            <option value="Ireland">Ireland</option>
                            <option value="Israel">Israel</option>
                            <option value="Italy">Italy</option>
                            <option value="Japan">Japan</option>
                            <option value="Jordan">Jordan</option>
                            <option value="Kazakhstan">Kazakhstan</option>
                            <option value="Latvia">Latvia</option>
                            <option value="Lebanon">Lebanon</option>
                            <option value="Lithuania">Lithuania</option>
                            <option value="Luxembourg">Luxembourg</option>
                            <option value="Malaysia">Malaysia</option>
                            <option value="Mexico">Mexico</option>
                            <option value="Netherlands">Netherlands</option>
                            <option value="New Zealand">New Zealand</option>
                            <option value="Norway">Norway</option>
                            <option value="Pakistan">Pakistan</option>
                            <option value="Peru">Peru</option>
                            <option value="Philippines">Philippines</option>
                            <option value="Poland">Poland</option>
                            <option value="Portugal">Portugal</option>
                            <option value="Romania">Romania</option>
                            <option value="Russia">Russia</option>
                            <option value="Saudi Arabia">Saudi Arabia</option>
                            <option value="Singapore">Singapore</option>
                            <option value="Slovakia">Slovakia</option>
                            <option value="Slovenia">Slovenia</option>
                            <option value="South Africa">South Africa</option>
                            <option value="South Korea">South Korea</option>
                            <option value="Spain">Spain</option>
                            <option value="Sweden">Sweden</option>
                            <option value="Switzerland">Switzerland</option>
                            <option value="Thailand">Thailand</option>
                            <option value="Turkey">Turkey</option>
                            <option value="Ukraine">Ukraine</option>
                            <option value="United Arab Emirates">United Arab Emirates</option>
                            <option value="Venezuela">Venezuela</option>
                            <option value="Vietnam">Vietnam</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="person_location">City or State (optional)</label>
                        <input type="text" id="person_location" name="person_location">
                    </div>
                </div>
                </div>
                
                <div class="form-group">
                    <label for="relevant_work_experience">Screenwriter Experience <span class="required">*</span></label>
                    <textarea id="relevant_work_experience" name="relevant_work_experience" placeholder="What are some of the Film/TV industry experiences that may have prepared you to work on this project." required></textarea>
                    <div class="char-count" id="relevant_work_experienceCount">0 characters</div>
                </div>
                
                <div class="form-group">
                    <label for="screenings_awards">Writing Career Highlights <span class="required">*</span></label>
                    <textarea id="screenings_awards" name="screenings_awards" placeholder="Share your notable TV/Film Industry related achievements and film festival awards/recognition." required></textarea>
                    <div class="char-count" id="screenings_awardsCount">0 characters</div>
                </div>
                
                <div class="form-group genre-section">
                    <label for="genres">Do you have any personal favorite genres? Click on all that apply.</label>
                    <div class="genre-grid">
                        <div class="genre-item">
                            <input type="checkbox" id="action" name="genres" value="Action">
                            <label for="action">Action</label>
                        </div>
                        <div class="genre-item">
                            <input type="checkbox" id="comedy" name="genres" value="Comedy">
                            <label for="comedy">Comedy</label>
                        </div>
                        <div class="genre-item">
                            <input type="checkbox" id="drama" name="genres" value="Drama">
                            <label for="drama">Drama</label>
                        </div>
                        <div class="genre-item">
                            <input type="checkbox" id="experimental" name="genres" value="Experimental">
                            <label for="experimental">Experimental</label>
                        </div>
                        <div class="genre-item">
                            <input type="checkbox" id="fantasy" name="genres" value="Fantasy">
                            <label for="fantasy">Fantasy</label>
                        </div>
                        <div class="genre-item">
                            <input type="checkbox" id="horror" name="genres" value="Horror">
                            <label for="horror">Horror</label>
                        </div>
                        <div class="genre-item">
                            <input type="checkbox" id="music_video" name="genres" value="Music Video">
                            <label for="music_video">Music Video</label>
                        </div>
                        <div class="genre-item">
                            <input type="checkbox" id="scifi" name="genres" value="Sci-Fi">
                            <label for="scifi">Sci-Fi</label>
                        </div>
                        <div class="genre-item">
                            <input type="checkbox" id="suspense_thriller" name="genres" value="Suspense Thriller">
                            <label for="suspense_thriller">Suspense Thriller</label>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="non_film_industry_experience">Non-Film Industry Related Experience <span class="required">*</span></label>
                    <textarea id="non_film_industry_experience" name="non_film_industry_experience" placeholder="Examples: As a student I experienced ... , as a parent I experienced ... , working in real estate for ten years I experienced ... growing up in Seattle I experienced ..." required></textarea>
                    <div class="char-count" id="non_film_industry_experienceCount">0 characters</div>
                </div>
                
                <div class="form-group">
                    <label for="community">Community <span class="required">*</span></label>
                    <textarea id="community" name="community" placeholder="In your own words, creatively do you feel like you career is focused on serving a particular audience? Examples: Autism Awareness, Latin community, LGBTQ community, Black Community, Religious Community, Family Programming, Environmental awareness? A political community? no preference?" required></textarea>
                    <div class="char-count" id="communityCount">0 characters</div>
                </div>
                
                <div class="form-group">
                    <label for="goals">Goals <span class="required">*</span></label>
                    <textarea id="goals" name="goals" placeholder="In the future, what are you working towards any goals? Examples: Work on big budget theatrical films or streaming programs? Join the Writer's Guild WGA?" required></textarea>
                    <div class="char-count" id="goalsCount">0 characters</div>
                </div>
                
                <div class="processing-options">
                    <div class="option-card" data-tier="standard" onclick="selectOption('standard')">
                        <div class="option-title">Standard Processing</div>
                        <button type="button" class="option-btn" id="standardBtn" onclick="selectOption('standard')">
                            Free
                        </button>
                        <div class="option-description">
                            Generate a professional writer's biography powered by Google Gemini.
                        </div>
                    </div>
                    
                    <div class="option-card" data-tier="premium" onclick="selectOption('premium')">
                        <div class="option-title">Premium Processing</div>
                        <button type="button" class="option-btn premium-btn" id="premiumBtn" onclick="selectOption('premium')">
                            Premium
                        </button>
                        <div class="option-description">
                            Generate a film industry standard writer's biography using Mikel Fair's signature algorithm powered by high end AI processing.
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="submit-btn" id="submitBtn" disabled>
                    Select processing option to continue
                </button>
            </form>
        </div>
    </div>
    
    <script src="../book-banner.js"></script>
    <script>
        createBookBanner('book-banner-container', 'writers-biography');
        
        const TEST_DATA = {
            first_name: 'Marcus',
            last_name: 'Thompson',
            country: 'United States',
            person_location: 'Austin, TX',
            relevant_work_experience: 'I have been writing screenplays for 6 years, starting with short scripts for local theater productions before transitioning to feature-length screenplays. I have completed 4 feature scripts and 15 shorts, with two of my features optioned by independent production companies. My writing process involves extensive character development and story structure analysis, drawing from my MFA in Creative Writing. I have also worked as a script reader for several production companies, giving me insight into what makes a screenplay compelling from both a creative and commercial perspective.',
            screenings_awards: 'My screenplay "The Last Migration" was a finalist at the Austin Film Festival and won the Best Drama award at the BlueCat Screenplay Competition. My short film "Fragments" (which I both wrote and directed) has been accepted to 18 film festivals and won Best Short Screenplay at the Montreal Independent Film Festival. I was selected for the prestigious Sundance Institute Screenwriters Lab and have been mentored by industry professionals including Academy Award nominee Sarah Chen. My feature screenplay "Urban Echoes" placed in the top 10% of the Nicholl Fellowship competition.',
            non_film_industry_experience: 'Before focusing on screenwriting full-time, I worked as a high school English teacher for 5 years, where I developed my storytelling skills and learned to engage diverse audiences. This experience taught me the importance of clear narrative structure and compelling character arcs. I also spent 3 years as a freelance journalist, covering local politics and social issues, which honed my research skills and gave me a deep understanding of how to find authentic stories in everyday life. My background in education and journalism has made me skilled at finding the human truth in complex situations.',
            community: 'My writing focuses on working-class stories and the experiences of first-generation Americans, particularly those from Latino and immigrant communities. Having grown up in a bilingual household, I am passionate about creating authentic representation that goes beyond stereotypes. I believe cinema has the power to build bridges between different communities and give voice to those who are often underrepresented in mainstream media. My goal is to write stories that honor the complexity and dignity of working-class experiences.',
            goals: 'My ultimate goal is to become a staff writer on a streaming series that focuses on diverse, character-driven stories. I want to work with production companies that prioritize authentic storytelling and social impact. Long-term, I hope to join the Writers Guild of America and eventually develop my own series. I am particularly interested in creating content that can reach both English and Spanish-speaking audiences, potentially working on bilingual productions that reflect the multicultural reality of modern America.'
        };
        
        function fillTestData() {
            Object.keys(TEST_DATA).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.value = TEST_DATA[key];
                    
                    if (element.tagName === 'TEXTAREA') {
                        const counter = document.getElementById(key + 'Count');
                        if (counter) {
                            counter.textContent = `${TEST_DATA[key].length} characters`;
                        }
                    }
                }
            });
            
            document.getElementById('drama').checked = true;
            document.getElementById('comedy').checked = true;
            document.getElementById('action').checked = true;
        }
        
        function clearForm() {
            document.getElementById('writersBiographyForm').reset();
            selectedTier = null;
            
            document.querySelectorAll('.option-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            document.getElementById('standardBtn').style.background = '#667eea';
            document.getElementById('premiumBtn').style.background = '#ff6b6b';
            
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.textContent = 'Select processing option to continue';
            
            document.querySelectorAll('.char-count').forEach(counter => {
                counter.textContent = '0 characters';
                counter.classList.remove('warning');
            });
        }
        
        let selectedTier = null;
        
        function selectOption(tier) {
            selectedTier = tier;
            
            document.querySelectorAll('.option-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            document.querySelector(`[data-tier="${tier}"]`).classList.add('selected');
            
            document.getElementById('standardBtn').style.background = tier === 'standard' ? '#5a67d8' : '#667eea';
            document.getElementById('premiumBtn').style.background = tier === 'premium' ? '#ff5252' : '#ff6b6b';
            
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = false;
            
            if (tier === 'standard') {
                submitBtn.textContent = 'Generate Writer\'s Biography (FREE)';
            } else {
                submitBtn.textContent = 'Generate Enhanced Writer\'s Biography (PREMIUM)';
            }
        }
        
        const textareas = ['relevant_work_experience', 'screenings_awards', 'non_film_industry_experience', 'community', 'goals'];
        
        textareas.forEach(id => {
            const textarea = document.getElementById(id);
            const counter = document.getElementById(id + 'Count');
            
            textarea.addEventListener('input', function() {
                const count = this.value.length;
                counter.textContent = `${count} characters`;
                
                if (count > 1000) {
                    counter.classList.add('warning');
                } else {
                    counter.classList.remove('warning');
                }
            });
        });
        
        const email = document.getElementById('email');
        const emailConfirm = document.getElementById('emailConfirm');
        const emailError = document.getElementById('emailError');
        
        emailConfirm.addEventListener('paste', function(e) {
            e.preventDefault();
        });
        
        function validateEmail() {
            if (email.value && emailConfirm.value && email.value !== emailConfirm.value) {
                emailError.style.display = 'block';
                emailConfirm.style.borderColor = '#e74c3c';
                return false;
            } else {
                emailError.style.display = 'none';
                emailConfirm.style.borderColor = '#e1e5e9';
                return true;
            }
        }
        
        email.addEventListener('input', validateEmail);
        emailConfirm.addEventListener('input', validateEmail);
        
        document.getElementById('writersBiographyForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (document.querySelector('input[name="website"]').value) {
                return;
            }
            
            if (!selectedTier) {
                alert('Please select a processing option.');
                return;
            }
            
            if (!validateEmail()) {
                alert('Please ensure both email addresses match.');
                return;
            }
            
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';
            
            const formData = new FormData(this);
            const submissionData = Object.fromEntries(formData.entries());
            
            const genreCheckboxes = document.querySelectorAll('input[name="genres"]:checked');
            const selectedGenres = Array.from(genreCheckboxes).map(cb => cb.value);
            submissionData.genres = selectedGenres;
            
            try {
                gtag('event', 'form_submit', {
                    'event_category': 'Tool_Usage',
                    'event_label': 'writers-biography-test',
                    'value': 1
                });
                
                const supabaseUrl = 'https://vmfhxkfprrbshwniguaq.supabase.co';
                const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZtZmh4a2ZwcnJic2h3bmlndWFxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk2ODYxNTcsImV4cCI6MjA2NTI2MjE1N30.k0OdvFzcO1nwZzxsgLPcQBeSITmV6dA_ncXpN0cpAgQ';
                
                const dbSubmission = {
                    first_name: submissionData.first_name,
                    last_name: submissionData.last_name,
                    email: submissionData.email,
                    country: submissionData.country,
                    person_location: submissionData.person_location,
                    relevant_work_experience: submissionData.relevant_work_experience,
                    screenings_awards: submissionData.screenings_awards,
                    genres: selectedGenres,
                    non_film_industry_experience: submissionData.non_film_industry_experience,
                    community: submissionData.community,
                    goals: submissionData.goals,
                    processing_tier: selectedTier,
                    status: 'pending'
                };
                
                const dbResponse = await fetch(`${supabaseUrl}/rest/v1/submissions_v3`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${supabaseKey}`,
                        'apikey': supabaseKey,
                        'Content-Type': 'application/json',
                        'Prefer': 'return=representation'
                    },
                    body: JSON.stringify(dbSubmission)
                });
                
                if (!dbResponse.ok) {
                    throw new Error(`Database submission failed: ${dbResponse.status}`);
                }
                
                const submission = await dbResponse.json();
                const submissionId = submission[0]?.id;
                
                if (!submissionId) {
                    throw new Error('No submission ID returned');
                }
                
                const processorResponse = await fetch(`${supabaseUrl}/functions/v1/writers-biography-processor`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${supabaseKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ submissionId, tier: selectedTier })
                });
                
                if (!processorResponse.ok) {
                    throw new Error(`Processing failed: ${processorResponse.status}`);
                }
                
                if (selectedTier === 'premium') {
                    submitBtn.textContent = 'Enhanced Writer\'s Biography Generated! Check Your Email';
                } else {
                    submitBtn.textContent = 'Writer\'s Biography Generated! Check Your Email';
                }
                submitBtn.style.backgroundColor = '#28a745';
                
                gtag('event', 'writers_biography_generated', {
                    'event_category': 'Success',
                    'event_label': 'writers-biography-test',
                    'tier': selectedTier,
                    'value': 1
                });
                
            } catch (error) {
                console.error('Submission error:', error);
                alert('There was an error processing your submission. Please try again.');
                
                submitBtn.disabled = false;
                submitBtn.textContent = selectedTier === 'premium' ? 'Generate Enhanced Writer\'s Biography (PREMIUM)' : 'Generate Writer\'s Biography (FREE)';
            }
        });
    </script>
    <div id="book-banner-container"></div>
</body>
</html>